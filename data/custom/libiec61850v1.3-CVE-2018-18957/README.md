# Exploit Title: libiec61850 1.3 - Stack Based Buffer Overflow

- Exploit Author: Dhiraj Mishra
- Vendor Homepage: <http://libiec61850.com/libiec61850/>
- Software Link: <https://github.com/mz-automation/libiec61850>
- Version: v1.3.0
- CVE: CVE-2018-18957

## Disclaimer

This is a containerized version of CVE-2018-18957 for research and testing purposes. This was created as part of my final year project in security research. While running this should be safe, there is no guarantee of safety on your machine. I hold no responsibility for any damages caused to others machines as a result of running any of the exploits in this dataset.

## Instructions 

Use the associated `make` commands to run the example exploit.

```
    make build # Builds the container, needs to be run once before all other commands 

    make clean # Removes unused docker containers, NOTE: can remove unrelated docker containers that are not in use!

    make run/demo # Runs an encapsulated demo of the exploit, to test against different hardening combinations set the HARDEN_FLAGS environment variable before running this 

    make run/bash # Opens a shell inside the build container for debugging and exploration. 
```

## Related Patch

```diff
hal/ethernet/linux/ethernet_linux.c
+1-1
Original file line number	Diff line number	Diff line change
@@ -155,7 +155,7 @@ Ethernet_getInterfaceMACAddress(const char* interfaceId, uint8_t* addr)

    memset(&buffer, 0x00, sizeof(buffer));

    -strcpy(buffer.ifr_name, interfaceId);
    +strncpy(buffer.ifr_name, interfaceId, IFNAMSIZ);

    ioctl(sock, SIOCGIFHWADDR, &buffer);

```

## References

- <https://github.com/mz-automation/libiec61850/issues/83>
- <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18957>