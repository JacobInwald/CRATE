#!/usr/bin/python3
import pandas as pd
import webbrowser


df = pd.read_csv('files_exploits.csv.orig', encoding='utf-8')

# apply linux and local filter

print('df\t\t', len(df))

df = df[df['platform'] == 'linux']
df = df[df['type'] == 'local']
print('df.Linux&Local:\t', len(df))

df['date_added'] = pd.to_datetime(df['date_added'], errors='coerce')
df = df[df['date_added'] > pd.Timestamp('2018-1-1')]

print('df.Date:\t', len(df))

df = pd.read_csv('files_exploits.csv.open', encoding='utf-8')

df = df[df['is_opensource']]

print('df.Open:\t', len(df))
df = df[~df['description'].str.contains('metasploit', case=False, na=False)]

print('df.Meta:\t', len(df))

df = pd.read_csv('files_exploits.csv.meta', encoding='utf-8')

df = df[df['is_c_based']]

print('df.C:\t\t', len(df))

df = pd.read_csv('files_exploits.csv', encoding='utf-8')

df = df[~df['instrumented']]
print('df.instr:\t', len(df))

df = df.drop_duplicates(subset=['id'], keep='first') 
print('df.dupe:\t', len(df))

df.to_csv('exploit-subset.csv', index=False)

